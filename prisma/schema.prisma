generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Novel {
  id     Int    @id @default(autoincrement())
  title  String
  author String
  intro  String
  notes  String
  reviewer_id String
  
  content String

  progress  Float
  per_chars Int
  price     Int
  length    Int

  hash String

  participants Participant[]

  @@map("novels")
}

enum Status {
  PENDING
  IN_PROGRESS
  Reviewing
  DONE
}

model Task {
  id        Int    @id @default(autoincrement())
  length    Int
  start     Int
  end       Int
  assign_id Int
  status    Status @default(PENDING)

  translated String
  trans_hash String

  participant_id Int?
  participant    Participant? @relation(fields: [participant_id], references: [id])
  Review         Review[]

  @@map("tasks")
}

model Participant {
  id Int @id

  novel_id Int
  novel    Novel  @relation(fields: [novel_id], references: [id])
  Task     Task[]

  @@map("participants")
}

model Review {
  id Int @id @default(autoincrement())

  comment Comment[]

  task_id Int
  task    Task @relation(fields: [task_id], references: [id])

  @@map("reviews")
}

model Comment {
  id Int @id @default(autoincrement())

  content  String
  Review   Review? @relation(fields: [reviewId], references: [id])
  reviewId Int?

  @@map("comments")
}
